# Python 裝飾器語法基礎教學

## 什麼是裝飾器？

裝飾器 (Decorator) 是一種 Python 特有的語法，它允許你在不修改原函數程式碼的情況下，增加或修改函數的功能。可以想像成幫函數「裝飾」上新的功能。

## 為什麼要用裝飾器？

*   **程式碼重用：** 將通用功能提取出來，避免重複編寫相同的程式碼。
*   **提高可讀性：** 使程式碼更簡潔、易懂。
*   **易於維護：** 修改裝飾器即可影響所有被裝飾的函數。

## 裝飾器基本語法

```python
@decorator_function
def my_function():
    # 函數程式碼
    pass
```

*   `@decorator_function`：使用 `@` 符號將裝飾器應用於 `my_function`。
*   `decorator_function`：裝飾器函數，它接收一個函數作為參數，並返回一個新的函數。
*   `my_function`：被裝飾的函數。

## 裝飾器範例：龍與地下城 RPG

假設我們正在開發一個龍與地下城 RPG 遊戲，我們想要為角色增加一些額外的功能，例如記錄日誌、檢查權限等。

### 範例 1：記錄日誌

```python
def log_execution(func):
    def wrapper(*args, **kwargs):
        print(f"執行 {func.__name__} 函數...")
        result = func(*args, **kwargs)
        print(f"{func.__name__} 函數執行完畢")
        return result
    return wrapper

@log_execution
def attack(character, target, damage):
    print(f"{character} 攻擊 {target}，造成 {damage} 點傷害！")

attack("英雄", "怪物", 10)
```

**說明：**

1.  `log_execution` 是一個裝飾器函數，它接收一個函數 `func` 作為參數。
2.  `wrapper` 是一個內部函數，它負責在 `func` 執行前後記錄日誌。
3.  `@log_execution` 將 `log_execution` 裝飾器應用於 `attack` 函數。
4.  當我們呼叫 `attack("英雄", "怪物", 10)` 時，實際上是呼叫 `wrapper("英雄", "怪物", 10)`。
5.  `wrapper` 函數會先印出 "執行 attack 函數..."，然後呼叫 `attack` 函數，最後印出 "attack 函數執行完畢"。

### 範例 2：檢查權限

```python
def check_permission(role):
    def decorator(func):
        def wrapper(*args, **kwargs):
            if role == "admin":
                print("權限驗證通過")
                return func(*args, **kwargs)
            else:
                print("權限不足")
                return
        return wrapper
    return decorator

@check_permission("admin")
def create_item(item_name):
    print(f"創建道具：{item_name}")

@check_permission("player")
def get_item(item_name):
    print(f"取得道具：{item_name}")

create_item("魔法劍")
get_item("魔法劍")
```

**說明：**

1.  `check_permission` 是一個帶參數的裝飾器函數，它接收一個角色 `role` 作為參數。
2.  `decorator` 是一個內部函數，它接收一個函數 `func` 作為參數。
3.  `wrapper` 是一個內部函數，它負責檢查角色是否有權限執行 `func`。
4.  `@check_permission("admin")` 將 `check_permission` 裝飾器應用於 `create_item` 函數，並傳入 "admin" 作為角色。
5.  `@check_permission("player")` 將 `check_permission` 裝飾器應用於 `get_item` 函數，並傳入 "player" 作為角色。
6.  當我們呼叫 `create_item("魔法劍")` 時，`wrapper` 函數會檢查角色是否為 "admin"，如果是，則執行 `create_item` 函數。
7.  當我們呼叫 `get_item("魔法劍")` 時，`wrapper` 函數會檢查角色是否為 "player"，如果不是，則印出 "權限不足"。

## 總結

裝飾器是一種強大的 Python 語法，它可以讓你以簡潔、優雅的方式增加或修改函數的功能。希望這個教學能幫助你理解裝飾器的基本概念和用法。